<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>ê°•ì•„ì§€ ì˜· ì‡¼í•‘ëª°!</title>
    <!-- Bootstrap CSS ì´ì¹œêµ¬!! í•„ìˆ˜ ì¶”ê°€!! -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css"
          integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">
    <!-- í°íŠ¸ ë¶ˆëŸ¬ì˜¤ê¸°!-->
    <link href="https://fonts.googleapis.com/css2?family=Yeon+Sung&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../static/shopping_css.css">  <!-- cssíŒŒì¼ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ê²ƒ-->

    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap ìë°”ìŠ¤í¬ë¦½íŠ¸ ë¶€ë¶„!! -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"
            integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
            crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"
            integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
            crossorigin="anonymous"></script>

    <script>
        $(document).ready(function () {
            $("#table-box").html("")
            showInfo()
            $("#erAPI").empty()
            $.ajax({
                type: "GET",
                url: "https://api.manana.kr/exchange/rate.json",
                data: {},
                success: function (response) {
                    let exchangeRate = response[1]['rate'];
                    console.log("í™˜ìœ¨ì€ " + exchangeRate)
                    $("#erAPI").append(`ë‹¬ëŸ¬-ì› í™˜ìœ¨: ${exchangeRate}`)
                }
            });
        });

        /*ì£¼ë¬¸í•˜ê¸° ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ post ë°©ì‹ìœ¼ë¡œ /order urlë¡œ dataë¥¼ ì „ë‹¬í•œë‹¤. */
        function orderButton() {
            let nameInput = $("#name")
            let name = nameInput.val()
            let count = $("#countSelect").val()
            let color = $("#colorSelect").val()
            let address = $("#address").val()
            let tell = $("#HP").val()

            if (isVal(name, address, tell)) {
                $.ajax({
                    type: "POST",
                    url: "/order",
                    data: {
                        "name_give": name,
                        "count_give": count,
                        "color_give": color,
                        "address_give": address,
                        "tell_give": tell
                    },
                    success: function (response) { // ì„±ê³µí•˜ë©´
                        if (response["result"] === "success") {
                            alert(response["msg"]);
                            nameInput.val("")
                            $("#address").val("")
                            $("#HP").val("")
                            $("#table-box").load(window.location.href + "#table-box");
                        }
                    }
                })
            }
        }

        /*ìœ íš¨ì„± ê²€ì‚¬*/
        function isVal(name, address, tell) {
            let rgEx = /[01](0|1|6|7|8|9)[-](\d{4}|\d{3})[-]\d{4}$/g;
            let chekFlag = rgEx.test(tell)

            if (name === "") {
                alert("ì£¼ë¬¸ì ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”")
            } else if (address === "") {
                alert("ì£¼ì†Œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”")
            } else if (tell === "") {
                alert("í•¸ë“œí° ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”")
            } else if (!chekFlag) {
                alert("ì˜¬ë°”ë¥¸ íœ´ëŒ€í° ë²ˆí˜¸ê°€ ì•„ë‹™ë‹ˆë‹¤")
            } else {
                return true
            }
        }

        /*DBì—ì„œ ê°€ì ¸ì˜¨ ê°’ tableì— ë¿Œë ¤ì£¼ê¸°*/
        function showInfo() {
            $.ajax({
                type: "GET",
                url: "/order",
                data: {},
                success: function (response) {
                    if (response["result"] === "success") {
                        let orderInfo = response['Info']
                        for (let i = 0; i < orderInfo.length; i++) {
                            let data = orderInfo[i]

                            let name = data['name']
                            let count = data['count']
                            let color = data['color']
                            let address = data['address']
                            let tell = data['tell']

                            let temp = `
                                            <tr>
                                                <td>${name}</td>
                                                <td>${color}</td>
                                                <td>${count}</td>
                                                <td>${address}</td>
                                                <td>${tell}</td>
                                            </tr>
                                        `

                            $("#table-box").append(temp)
                        }
                    }
                }
            })
        }

    </script>
</head>
<body>

<div class="wrap">
    <!--ì´ë¯¸ì§€-->
    <div id="carouselExampleIndicators" class="carousel slide image-size align-basic" data-ride="carousel">
        <ol class="carousel-indicators">
            <li data-target="#carouselExampleIndicators" data-slide-to="0" class="active"></li>
            <li data-target="#carouselExampleIndicators" data-slide-to="1"></li>
            <li data-target="#carouselExampleIndicators" data-slide-to="2"></li>
        </ol>
        <div class="carousel-inner ">
            <div class="carousel-item active">
                <img class="d-block w-100"
                     src="http://gi.esmplus.com/avenireve/totonroy/2019/SummerCheckCropSleeveless/bk3.jpg"
                     alt="First slide">
            </div>
            <div class="carousel-item image-size">
                <img class="d-block w-100"
                     src="http://gi.esmplus.com/avenireve/totonroy/2019/SummerCheckCropSleeveless/re.jpg"
                     alt="Second slide">
            </div>
            <div class="carousel-item ">
                <img class="d-block w-100"
                     src="http://gi.esmplus.com/avenireve/totonroy/2019/SummerCheckCropSleeveless/red2.jpg"
                     alt="Third slide">
            </div>
        </div>
        <a class="carousel-control-prev" href="#carouselExampleIndicators" role="button" data-slide="prev">
            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
            <span class="sr-only">Previous</span>
        </a>
        <a class="carousel-control-next" href="#carouselExampleIndicators" role="button" data-slide="next">
            <span class="carousel-control-next-icon" aria-hidden="true"></span>
            <span class="sr-only">Next</span>
        </a>
    </div>
    <br>

    <!--ì„¤ëª…-->
    <h1>ì¸ë¨¸ì²´í¬ í¬ë¡­ ë‚˜ì‹œ(â—'â—¡'â—)<span class="price">ê°€ê²© : 28000ì› / ì¥</span></h1>
    <p>ì—¬ë¦„ì„ ê°€ë“ ë‹´ì€ "ì¸ë¨¸ì²´í¬ í¬ë¡­ ë‚˜ì‹œ"ë¥¼ ì†Œê°œí•©ë‹ˆë‹¤. <br>
        ì•™ì¦ë§ì€ ë’·íƒœë¥¼ ë§Œë“¤ì–´ì£¼ëŠ” í¬ë¡­ ê¸°ì¥ê³¼ ì‹œì›í•œ ì¸ë¨¸ì²´í¬ê°€ ë§Œë‚œ ì¸ë¨¸ ìœ ë‹‰í…œ! <br>
        ì–‡ê³  ì‹œì›í•˜ë©° ë¶€ë“œëŸ¬ìš´ ì´‰ê°ì˜ í´ë¦¬,ë©´ ì†Œì¬ê°€ í˜¼ë°© ëœ ì œí’ˆìœ¼ë¡œ, í•œ ì—¬ë¦„ ë‚´ë‚´ ì°©ìš©í•˜ê¸° ì¢‹ì€ ì•„ì´ëë‹ˆë‹¤. <br>
        ì¨í•œ ì»¬ëŸ¬ê°ì´ ì—¬ë¦„ê³¼ ë„ˆë¬´ë‚˜ ì˜ ì–´ìš¸ë¦¬ë©°, ë°°ì™€ ë“±ë¶€ë¶„ì— ìŠ¤ëª¨í‚¹ ì²˜ë¦¬ë¡œ ì‹ ì¶•ì„± ë˜í•œ ì ë‹¹í•˜ì—¬ í¸ì•ˆí•œ ì°©ìš©ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤! </p>
    <br>

    <!--ì£¼ë¬¸í•˜ê¸°-->
    <h1>ì£¼ë¬¸í•˜ê¸°ğŸ§¾<span id="erAPI">ë‹¬ëŸ¬-ì› í™˜ìœ¨ : 1010</span></h1>
    <div class="form-group row">
        <label class="col-sm-2 col-form-label">ì£¼ë¬¸ì ì„±í•¨: </label>
        <div class="col-sm-10">
            <input type="text" class="form-control" id="name" placeholder="ê¹€OO">
        </div>
    </div>
    <div class="form-group row">
        <label for="countSelect" class="col-sm-2 col-form-label">ìˆ˜ëŸ‰ : </label>
        <div class="col-sm-10">
            <select class="form-control" id="countSelect">
                <option>1</option>
                <option>2</option>
                <option>3</option>
                <option>4</option>
                <option>5</option>
            </select>
        </div>
    </div>
    <div class="form-group row">
        <label for="colorSelect" class="col-sm-2 col-form-label">ìƒ‰ê¹” : </label>
        <div class="col-sm-10">
            <select class="form-control" id="colorSelect">
                <option>ê²€ì •</option>
                <option>ë…¸ë‘</option>
                <option>ë¹¨ê°•</option>
            </select>
        </div>
    </div>
    <div class="form-group row">
        <label class="col-sm-2 col-form-label">ì£¼ì†Œ : </label>
        <div class="col-sm-10">
            <input type="text" class="form-control" id="address" placeholder="ë„ë¡œëª…ìœ¼ë¡œ ì…ë ¥í•´ì£¼ì„¸ìš”!">
        </div>
    </div>
    <div class="form-group row">
        <label class="col-sm-2 col-form-label">ì „í™”ë²ˆí˜¸ : </label>
        <div class="col-sm-10">
            <input type="text" class="form-control" id="HP" placeholder="010-xxxx-xxxx">
        </div>
    </div>

    <button type="button" onclick="orderButton()" class="btn btn-outline-dark btn-block button-size align-basic ">ì£¼ë¬¸í•˜ê¸°
    </button>
    <br><br>
    <hr>

    <!--ì£¼ë¬¸í™•ì¸ ê²Œì‹œíŒ , table-->
    <h1 style="margin-top: 50px">ì£¼ë¬¸í™•ì¸ ê²Œì‹œíŒğŸ“Œ</h1>
    <table class="table table-borderless">
        <thead>
        <tr>
            <th scope="col">ì£¼ë¬¸ì ì„±í•¨</th>
            <th scope="col">ìƒ‰ê¹”</th>
            <th scope="col">ìˆ˜ëŸ‰</th>
            <th scope="col">ì£¼ì†Œ</th>
            <th scope="col">ì „í™”ë²ˆí˜¸</th>
        </tr>
        </thead>
        <tbody id="table-box">
        </tbody>
    </table>
</div>

</body>
</html>